<% content_for :title do 
  "Movies"
end %>

<% if defined? @now_playing %>
  <h3>In Theatres</h3>
  <div class="<%= if @paging 
  "movies" 
  else "movie-slider"
  end %>">
    <% @now_playing['results'].each do |movie| %>
      <%= render partial: "shared/movieposter", locals: {movie: movie, width: 154} %>
    <% end %>
  </div>
<% end %>


<% if defined? @popular %>
  <h3>Popular Movies</h3>
  <div class="<%= if @paging 
  "movies" 
  else "movie-slider"
  end %>">
    <% @popular['results'].each do |movie| %>
      <%= render partial: "shared/movieposter", locals: {movie: movie, width: 154} %>
    <% end %>
  </div>
<% end %>

<% if @paging %>
<script>
  $(".movie").each(function(i, el){
    $el = $(el);
    $el.wrap("<div class='col-6 col-sm-3'></div>");
    
    if (i % 4 == 0)
      $(".movies").append("<div class='row'></div>");
      
    $el.parent().appendTo(".movies .row:last");
    
  });
</script>

<% else %>

<script>
  $(function(){
    $(".movie-slider").bxSlider({
        minSlides: 2,
        maxSlides: 10,
        moveSlides: 1,
        mode: 'horizontal',
        slideWidth: 150,
        slideMargin: 20,
        pager: false
    });
  })
</script>

<% end %>